title: FabricScape (CVE-2022-30137) - Azure Service Fabric privilege escalation
slug: CVE-2022-30137
cves:
- cve-2022-30137
affectedPlatforms:
- Azure
affectedServices:
- Service Fabric
image: https://raw.githubusercontent.com/wiz-sec/open-cvdb/main/images/fabricscape.jpg
severity: Medium
piercingIndexVector: {version: 1.5, A3: 1.05, A4: 1.05, A5: 1.05, A6: 3, A7: 1.1,
  A8: 1.1}
discoveredBy:
  name: Aviv Sasson
  org: Palo Alto Networks
  domain: https://unit42.paloaltonetworks.com
  twitter:
disclosedAt: 2022/06/14
publishedAt: 2022/06/28
exploitabilityPeriod: until 2022/05/24
knownITWExploitation: false
summary: |
  A vulnerability in Service Fabric allows Linux containers to escalate their privileges in
  order to gain root privileges on the node, and then compromise all of the nodes in the cluster.
  An attacker would need to have read/write access to the cluster, and the vulnerability could be
  exploited on containers that are configured to have runtime access, but this is granted by default
  to every container. Though the bug exists in both the Windows and Linux versions, it is only
  exploitable on Linux.
manualRemediation: |
  Users can check their current Service Fabric version by navigating to their Service Fabric
  cluster in the Azure console and then clicking on "Fabric upgrades".
  If the Fabric upgrade mode is configured to "Automatic", the cluster will be updated automatically
  to the latest secure version. If Fabric upgrade mode is configured to "Manual",
  customers must update it manually to the latest version (9.0.1035.1 or higher).
detectionMethods: Linux Service Fabric runtime < 9.0.1035.1
contributor: https://github.com/leszekgrzegorek
references:
- https://unit42.paloaltonetworks.com/fabricscape-cve-2022-30137/
- https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-30137
- https://msrc-blog.microsoft.com/2022/06/28/azure-service-fabric-privilege-escalation-from-containerized-workloads-on-linux/
entryStatus: Finalized
