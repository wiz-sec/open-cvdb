title: Subdomain Takeover Vulnerability in GitLab Pages
slug: subdomain-takeover-vulnerability-gitlab-pages
cves: [CVE-2024-5528]
affectedPlatforms: [GitLab]
affectedServices:
  - GitLab Pages
image: https://images.unsplash.com/INSERT_IMAGE_HERE?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1173&q=80
severity: Low
discoveredBy:
  name: Philippe Delteil
  org: 
  domain: 
  twitter: https://x.com/PhilippeDelteil
publishedAt: 2024/05/28
disclosedAt: 2024/10/09
exploitabilityPeriod: 
knownITWExploitation: false
summary: |
  A vulnerability in GitLab Pages allowed attackers to take over dangling custom domains pointing to 'instanceX.gitlab.io'. The issue occured when adding an unverified custom domain to GitLab Pages, which serves content for 7 days before disabling. This could lead to cookie stealing, phishing campaigns, and bypassing of Content-Security Policies and CORS.
manualRemediation: |
  Disable the "Force HTTPS" option in GitLab Pages settings for the affected project. Verify and properly configure custom domains before adding them to GitLab Pages.
detectionMethods: |
  Monitor for unexpected changes in DNS records pointing to GitLab Pages. Regularly audit custom domain configurations in GitLab Pages settings. Check for unauthorized content served on custom domains associated with GitLab Pages.
contributor: https://github.com/sshayb
entryStatus: Finalized
references:
  - https://gitlab.com/gitlab-org/gitlab/-/issues/464558