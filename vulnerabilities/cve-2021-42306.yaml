title: CredManifest (Azure AD keyCredential property information disclosure)
slug: cve-2021-42306
cves:
- CVE-2021-42306
affectedPlatforms:
- Azure
affectedServices:
- AAD
image: 
  https://images.pexels.com/photos/7630510/pexels-photo-7630510.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1
severity: High
piercingIndexVector: {version: 1.5, A3: 1.05, A4: 1.05, A5: 1.05, A6: 6, A7: 1.1,
  A8: 1.1}
discoveredBy:
  name: Karl Fosaaen
  org: NetSPI
  domain: https://www.netspi.com/
  twitter:
publishedAt: 2021/11/17
disclosedAt: 2021/10/07
exploitabilityPeriod:
knownITWExploitation: false
summary: |
  Automation Account 'Run as' credentials (PFX certificates) were being stored
  in cleartext, in Azure Active Directory (AAD). These credentials were available
  to anyone with the ability to read information about App Registrations (typically
  most AAD users).
manualRemediation: |
  Regenerate exposed certificate
detectionMethods:
contributor: https://github.com/a10ns
references:
- https://msrc-blog.microsoft.com/2021/11/17/guidance-for-azure-active-directory-ad-keycredential-property-information-disclosure-in-application-and-service-principal-apis/
- https://github.com/microsoft/aad-app-credential-tools/blob/main/azure-migrate/azure-migrate-credential-rotation-guide.md
- https://www.netspi.com/blog/technical/cloud-penetration-testing/azure-cloud-vulnerability-credmanifest/
entryStatus: Finalized
