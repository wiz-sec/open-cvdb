title: Imposter commits vulnerability in GitHub Actions
slug: imposter-commits-vulnerability-github-actions
cves: null
affectedPlatforms:
  - GitHub
affectedServices:
  - GitHub Actions
image: https://images.unsplash.com/INSERT_IMAGE_HERE?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1173&q=80
severity: Medium
discoveredBy:
  name: Billy Lynch
  org: Chainguard
  domain: chainguard.dev
  twitter: wflynch
publishedAt: 2023/03/08
disclosedAt: 2022/09/08
exploitabilityPeriod: Ongoing, partially mitigated
knownITWExploitation: false
summary: |
  A vulnerability in GitHub Actions allows bypassing workflow settings using commits from forked repositories (rather than commits of the main action repo). This "imposter commits" issue can potentially introduce untrusted code into CI/CD pipelines, posing a risk to the security of the software supply chain. The vulnerability stems from GitHub's handling of forked repositories and how commits are shared between forks and parent repositories. A partial solution to this was GitHub prohibiting partial commit references in workflows, however, no full solution exists currently.
manualRemediation: |
  Remove action dependencies that Enable automated tools such as Dependabot to keep GitHub Actions up to date with known branches/tags.
detectionMethods: |
  Audit CI configurations, particularly for sensitive workflows like deployments or artifact signing, to identify any vulnerability to fetching arbitrary imposter commits. Either manually (by auditing action commit hashes and verifying those are part of the main action repo), or by using the open-source tool clank (by Chainguard) to check for potential imposter commits in GitHub Action workflows. 
contributor: https://github.com/sshayb
entryStatus: Finalized
references:
  - https://www.chainguard.dev/unchained/what-the-fork-imposter-commits-in-github-actions-and-ci-cd
