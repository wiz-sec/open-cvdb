title: Azure CLI code injection vulnerability
slug: cve-2022-39327
cves: null
affectedPlatforms:
- Azure
affectedServices:
- Azure CLI
image: https://cdn.pixabay.com/photo/2018/04/11/08/59/rails-3309912_1280.jpg
severity: Medium
discoveredBy:
  name: null
  org: Microsoft
  domain: microsoft.com
  twitter: null
publishedAt: 2022/10/25
disclosedAt: null
exploitabilityPeriod: null
knownITWExploitation: false
summary: |
  Azure CLI contained a code injection vulnerability that could be exploited in
  a scenario where the host runs a command where parameter values have been provided
  by an external untrusted source - these could be specially crafted in such a way
  as to exploit the vulnerability, leading to remote code execution on the host.
  The vulnerability is only applicable when the Azure CLI command is run on a Windows
  machine and with any version of PowerShell and when the parameter value contains
  the `&` or `|` symbols.
manualRemediation: |
  Upgrade to Azure CLI 2.40.0 or greater.
detectionMethods: null
contributor: https://github.com/fooinha
references:
- https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-39327
- https://github.com/Azure/azure-cli/security/advisories/GHSA-47xc-9rr2-q7p4
- https://github.com/Azure/azure-cli/pull/23514
- https://github.com/Azure/azure-cli/pull/24015
