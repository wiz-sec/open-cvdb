title: Google OAuth Vulnerability Allows Indefinite Access
slug: google-oauth-vulnerability-indefinite-access
cves: []
affectedPlatforms:
  - gcp
affectedServices:
  - OAuth
  - Slack
  - Zoom
image:
severity: high
discoveredBy:
  name: Dylan Ayrey
  org: Truffle Security Co.
  domain: trufflesecurity.com
  twitter:
publishedAt: 2023/12/15
disclosedAt: 2023/08/04
exploitabilityPeriod: Until 2023/12/15
knownITWExploitation: false
summary: |
  A vulnerability in Google OAuth allows employees to retain indefinite access to applications like Slack and Zoom after being removed from their company's Google organization. The issue stems from the ability to create Google accounts using corporate email aliases, which can't be off-boarded by the organization. This bypasses typical account removal processes and poses a significant security risk.
manualRemediation: |
  Organizations should disable login with Google and strictly enforce SAML authentication. Service providers should use the HD claim instead of email for authentication and implement invite-only or LDAP group-only account provisioning.
detectionMethods: |
  Organizations can audit their Google organization settings and check for any non-Gmail Google accounts using corporate email addresses. Service providers can review their OAuth implementation to ensure they're not relying solely on the email claim for authentication.
contributor: https://github.com/korniko98
entryStatus: Stub (AI-Generated)
references:
  - https://trufflesecurity.com/blog/google-oauth-is-broken-sort-of/
