title: Azure CLI Leaks Credentials in GitHub Actions Logs
slug: azure-cli-leaks-credentials-github-actions-logs
cves: 
  - CVE-2023-36052
affectedPlatforms:
  - Azure
  - GitHub
affectedServices:
  - Azure CLI
  - GitHub Actions
image: null
severity: High
discoveredBy:
  name: Aviad Hahami
  org: Palo Alto Networks
  domain: paloaltonetworks.com
  twitter: null
publishedAt: 2023/11/14
disclosedAt: 2023/07/01
exploitabilityPeriod: Until 2023/11/14
knownITWExploitation: false
summary: |
  Azure CLI commands were found to leak sensitive credentials and environment variables in GitHub Actions logs. This issue affects both public and private repositories, potentially exposing secrets to unauthorized parties. The problem stems from the Azure CLI's design to echo back accessed/created/updated/deleted resource information, which can include sensitive data.
manualRemediation: |
  Update Azure CLI to version 2.54 or later. Use Azure Key Vault for sensitive values. Store command outputs in variables or use JMESPath queries. Redirect output to /dev/null or use the "--output none" option when running Azure CLI commands in pipelines.
detectionMethods: |
  Review GitHub Actions logs for exposed credentials. Check Azure CLI command usage in workflows for proper output handling. Use secrets scanning tools to identify potentially leaked secrets in repository history.
contributor: https://github.com/korniko98
entryStatus: Finalized
references:
  - https://www.paloaltonetworks.com/blog/cloud-security/secrets-leakage-user-error-azure-cli/
  - https://msrc.microsoft.com/update-guide/en-US/advisory/CVE-2023-36052
