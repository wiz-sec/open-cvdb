title: GCP Cloud Functions Privilege Escalation Vulnerability
slug: gcp-cloud-functions-privilege-escalation-vulnerability
cves: null
affectedPlatforms:
  - GCP
affectedServices:
  - Cloud Functions
  - Cloud Build
image: https://images.unsplash.com/photo-1562268860-f314f1973750?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1173&q=80
severity: High
discoveredBy:
  name: Liv Matan
  org: Tenable
  domain: tenable.com
  twitter: null
publishedAt: 2024/07/24
disclosedAt: null
exploitabilityPeriod: Until mid-June 2024
knownITWExploitation: false
summary: |
  A privilege escalation vulnerability dubbed "ConfusedFunction" was discovered in Google Cloud Platform's Cloud Functions service. It allows attackers to escalate privileges from Cloud Function permissions to the default Cloud Build service account during function deployment. The vulnerability affects both first and second-generation Cloud Functions.
manualRemediation: |
  For every cloud function using the legacy Cloud Build service account, replace it with a least-privilege service account.
detectionMethods: |
  Monitor for suspicious activity related to Cloud Function deployments and Cloud Build instances. Review IAM permissions and service account usage for Cloud Functions and Cloud Build.
contributor: https://github.com/mer-b
entryStatus: Finalized
references:
  - https://www.tenable.com/blog/confusedfunction-a-privilege-escalation-vulnerability-impacting-gcp-cloud-functions
