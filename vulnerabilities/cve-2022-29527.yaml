title: AWS SSM agent local privilege escalation
slug: cve-2022-29527
cves: CVE-2022-29527
affectedPlatforms:
- AWS
affectedServices:
- SSM
- EC2
image: 
  https://images.unsplash.com/photo-1575252663512-b25714ec27f9?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=2074&q=80
severity: High
discoveredBy:
  name: Matthias Gerstner
  org: SUSE
  domain: https://www.suse.com/
  twitter:
disclosedAt: 2022/02/28
publishedAt: 2022/04/20
exploitabilityPeriod: until 2022/04/05
knownITWExploitation: false
summary: |
  The Amazon SSM Agent (used for managing EC2 instances via Amazon Systems Manager) created a world-writable sudoers file,
  which would have allowed local attackers to inject Sudo rules and escalate privileges to root.
  This could occur in certain situations involving a race condition.
manualRemediation: |
  Update the agent to the patched version (3.1.1208)
detectionMethods:
contributor: https://github.com/mer-b
references:
- https://github.com/advisories/GHSA-87pw-p9qx-p46w
- https://github.com/aws/amazon-ssm-agent/releases/tag/3.1.1208.0
- https://bugzilla.suse.com/show_bug.cgi?id=1196556
entryStatus: Finalized
